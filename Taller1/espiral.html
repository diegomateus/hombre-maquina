<html>
    <head>
        <title>My first three.js app</title>
        <style>
            body { margin: 0; }
            canvas { display: block; }
        </style>
    </head>
    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
        <script>
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );

            var renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );
                        
            var l1 = 12
            var l2 = 12
            var geometry = new THREE.BoxGeometry(1,l1,1);
            
            var geometry2 = new THREE.BoxGeometry(2,2,2);
            var geometryPoint = new THREE.BoxGeometry(0.1,0.1,0.1);
            var material = new THREE.MeshBasicMaterial( { color: 0x00ffff } );//azul
            var material2 = new THREE.MeshBasicMaterial( { color: 0xff00ff } );//morado
            var material3 = new THREE.MeshBasicMaterial( { color: 0xffff00 } );//amarillo
            var cube = new THREE.Mesh( geometry, material );
            var cube2 = new THREE.Mesh( geometry, material2 );
            var cube3 = new THREE.Mesh( geometry2, material3 );
            scene.add( cube3 );
            var contenedor = new THREE.Object3D();            
            var contenedor2 = new THREE.Object3D();
            
            cube.position.y=-l1/2
            contenedor.add(cube)
            cube2.position.y=-l1/2
            contenedor2.add(cube2)
            contenedor2.position.y=-l1
            contenedor.add( contenedor2);
            scene.add( contenedor );
            

            camera.position.z = 30;
            
            var ang = [0,0]
            cube3.position.x = 0;
            cube3.position.y = 0;
            var calcular = function(x,y){
                var a2=Math.PI-Math.acos((l1*l1+l2*l2-x*x-y*y)/(2*l1*l2));
                var a1=Math.atan(y/x)-Math.atan((l1*Math.sin(a2))/(l1+l2*Math.cos(a2)));      
                ang = [a1,a2];
            }
            var t = 0;
            var animate = function () {
                requestAnimationFrame( animate );
                t += 0.05

                if(t <= 50){
                    cube3.position.x = (Math.cos(t)*(t*0.2)) + 10 ;
                    cube3.position.y = t * 0.2
                    cube3.position.z = (Math.sin(t)*(t*0.2)) + 10;
                }
                
                var cubeA = new THREE.Mesh( geometryPoint, material );
                
                cubeA.position.x = cube3.position.x
                cubeA.position.y = cube3.position.y
                cubeA.position.z = cube3.position.z

                //contenedor2.add(cube3)

                scene.add( cubeA );
                calcular(cube3.position.x,cube3.position.y);
                contenedor.rotation.x = Math.atan(cube3.position.z/cube3.position.y);
                contenedor.rotation.z = (ang[0]+Math.PI/2);
                contenedor2.rotation.z = ang[1]
 
                renderer.render(scene, camera);
            };
            animate();
        </script>
    </body>
</html>